#! /usr/bin/env node
const semver = require('semver');
const package = require('../package.json');

const engineVersion = package.engines.node;

if (!semver.satisfies(process.version, engineVersion)) {
  console.log(`Required node version ${engineVersion} not satisfied with current version ${process.version}.`);
  process.exit(1);
}

const VM = require('../src/emulator/console/vm');
const program = require('commander').program;
const version = package.version;
let options = {};

program.version(version);
program
	.description('Emulator for Grey Hack.')
	.option('-p, --path <path>', 'Path to Grey Hack');

program.parse(process.argv);

(function() {
	options = Object.assign(options, program.opts());

	if (options.path !== null) {
		process.env['GREY_HACK_PATH'] = options.path;
	}

	(new VM()).start();
})();